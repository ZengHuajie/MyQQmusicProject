var dataList,len,control,timer,root=window.player,audio=root.audioManager,proControl=root.proControl;function getData(o){$.ajax({url:o,type:"GET",success:function(o){len=(dataList=o).length,control=new root.control(len),root.render(dataList[0]),audio.getAudio(dataList[0].audio),proControl.renderAllTime(dataList[0].duration),bindEvent(),bindTouch()},error:function(){}})}function bindEvent(){$("body").on("play-change",function(o,t){audio.getAudio(dataList[t].audio),root.render(dataList[t]),proControl.renderAllTime(dataList[t].duration),"play"==audio.status&&(audio.play(),rotate(0)),$(".img-box").attr("data-deg",0),$(".img-box").css({transform:"rotateZ(0deg)"})}),$(".prev").on("click",function(){var o=control.prev();$("body").trigger("play-change",o),proControl.start(0),"pause"==audio.status&&(audio.pause(),proControl.stop())}),$(".next").on("click",function(){var o=control.next();$("body").trigger("play-change",o),proControl.start(0),"pause"==audio.status&&(audio.pause(),proControl.stop())}),$(".play").on("click",function(){if("pause"==audio.status){audio.play();var o=$(".img-box").attr("data-deg");proControl.start(),rotate(o),audio.status="play"}else audio.pause(),proControl.stop(),clearInterval(timer);$(".play").toggleClass("playing")})}function rotate(o){clearInterval(timer),o=+o,timer=setInterval(function(){o+=2,$(".img-box").attr("data-deg",o),$(".img-box").css({transform:"rotateZ("+o+"deg)","transition:":"all 1s ease-in"})},100)}function bindTouch(){var r=$(".pro-wrap").offset().left,n=$(".pro-wrap").offset().width;$(".spot").on("touchstart",function(){root.proControl.stop()}).on("touchmove",function(o){var t=(Math.round(o.changedTouches[0].clientX)-r)/n;0<t&&t<=.98&&root.proControl.update(t)}).on("touchend",function(o){var t=(Math.round(o.changedTouches[0].clientX)-r)/n;if(0<t&&t<=.98){var a=t*dataList[control.index].duration;$(".play").addClass("playing"),audio.playTo(a),audio.play(),audio.status="play",root.proControl.start(t)}})}getData("../mock/data.json");